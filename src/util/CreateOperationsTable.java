/** **********
 *
 *      Class:         CreateOperationsTable.java
 *      Package:       util
 *      Date:          October 14, 2018
 *
 *      Course: UMUC CMSC 495 6381
 *      Group A Members: John Tamer, Jason Grimard, Demetrius Billups, & Emily Hoppe
 *
 *      Class Description: CreateOperationsTable is a static utility class that is
 *                  used to create a table in the database and fill it with
 *                  sample data.
 *
 *
 *********** */
package util;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import javax.swing.JOptionPane;

public class CreateOperationsTable {

    public static void createTable() {
        final String CONNECTION = "jdbc:derby:FlightHours;create=true";
        boolean okayToCreate = false;

        try {
            Connection conn = DriverManager.getConnection(CONNECTION);
            Statement s = conn.createStatement();
            s.execute("SELECT '1' FROM operations");
        } catch (SQLException sqle) {
            String theError = (sqle).getSQLState();
            if (theError.equals("42X05")) // Table does not exist
            {
                okayToCreate = true;
            } else {
                JOptionPane.showMessageDialog(null, "CreateOperationsTable Database Error: " + theError,
                        "Error", JOptionPane.ERROR_MESSAGE);
            }
        }
        if (okayToCreate) {
            try (Connection conn = DriverManager.getConnection(CONNECTION);
                    Statement statement = conn.createStatement()) {
                statement.executeUpdate("CREATE TABLE operations ( "
                        + " operation_id INT NOT NULL GENERATED ALWAYS AS IDENTITY, "
                        + " aircraft_id INT NOT NULL,"
                        + " station_id INT NOT NULL,"
                        + " mission_id INT NOT NULL,"
                        + " operation_name VARCHAR(20) NOT NULL,"
                        + " operation_start_date DATE NOT NULL,"
                        + " operation_end_date DATE NOT NULL,"
                        + " operation_flight_hours INT NOT NULL)");

                System.out.println("OPERATIONS table created.");

                //Insert rows of sample data into the table
                try {
                    Statement insertStatement = conn.createStatement();
                    insertStatement.executeUpdate("INSERT INTO operations ("
                            + "aircraft_id,"
                            + "station_id,"
                            + "mission_id,"
                            + "operation_name,"
                            + "operation_start_date,"
                            + "operation_end_date,"
                            + "operation_flight_hours)"
                            + "VALUES"
                            + "(8,22,7,'Operation 1 ','2015-01-13','2015-01-15',22),"
                            + "(15,28,6,'Operation 2','2015-01-16','2015-01-21',56),"
                            + "(30,22,4,'Operation 3','2015-01-24','2015-01-26',30),"
                            + "(16,19,7,'Operation 4','2015-01-30','2015-01-31',13),"
                            + "(33,28,4,'Operation 5','2015-03-06','2015-03-08',26),"
                            + "(21,19,3,'Operation 6','2015-05-06','2015-05-10',35),"
                            + "(17,25,7,'Operation 7','2015-05-09','2015-05-09',9),"
                            + "(9,26,3,'Operation 8','2015-05-13','2015-05-15',31),"
                            + "(22,23,7,'Operation 9','2015-05-14','2015-05-19',46),"
                            + "(1,20,1,'Operation 10','2015-05-14','2015-05-16',29),"
                            + "(28,29,7,'Operation 11','2015-05-18','2015-05-18',3),"
                            + "(14,19,7,'Operation 12','2015-05-29','2015-05-30',20),"
                            + "(8,23,3,'Operation 13','2015-05-31','2015-06-03',38),"
                            + "(4,26,4,'Operation 14','2015-06-10','2015-06-15',47),"
                            + "(10,23,2,'Operation 15','2015-06-24','2015-06-27',35),"
                            + "(28,23,4,'Operation 16','2015-07-23','2015-07-26',29),"
                            + "(25,19,1,'Operation 17','2015-07-28','2015-07-28',7),"
                            + "(14,28,6,'Operation 18','2015-08-02','2015-08-07',45),"
                            + "(34,23,7,'Operation 19','2015-08-03','2015-08-07',48),"
                            + "(8,21,1,'Operation 20','2015-08-12','2015-08-16',37),"
                            + "(28,29,5,'Operation 21','2015-08-22','2015-08-24',23),"
                            + "(15,20,4,'Operation 22','2015-08-24','2015-08-25',23),"
                            + "(18,23,5,'Operation 23','2015-08-25','2015-08-30',46),"
                            + "(3,20,5,'Operation 24','2015-08-30','2015-09-02',37),"
                            + "(22,20,2,'Operation 25','2015-09-02','2015-09-04',20),"
                            + "(1,18,3,'Operation 26','2015-09-15','2015-09-19',42),"
                            + "(26,25,1,'Operation 27','2015-09-20','2015-09-25',55),"
                            + "(23,22,4,'Operation 28','2015-09-21','2015-09-26',49),"
                            + "(24,27,1,'Operation 29','2015-09-25','2015-09-25',16),"
                            + "(6,19,4,'Operation 30','2015-09-27','2015-09-27',6),"
                            + "(26,29,1,'Operation 31','2015-09-28','2015-10-02',38),"
                            + "(34,19,2,'Operation 32','2015-10-14','2015-10-18',38),"
                            + "(21,21,1,'Operation 33','2015-10-31','2015-11-05',44),"
                            + "(22,19,5,'Operation 34','2015-11-06','2015-11-11',48),"
                            + "(34,29,3,'Operation 35','2015-11-09','2015-11-11',21),"
                            + "(15,20,4,'Operation 36','2015-11-16','2015-11-19',37),"
                            + "(29,21,3,'Operation 37','2015-11-27','2015-11-27',9),"
                            + "(13,20,7,'Operation 38','2015-12-04','2015-12-08',37),"
                            + "(26,18,2,'Operation 39','2015-12-07','2015-12-10',38),"
                            + "(34,25,5,'Operation 40','2015-12-11','2015-12-11',11),"
                            + "(29,24,5,'Operation 41','2015-12-19','2015-12-21',18),"
                            + "(22,29,4,'Operation 42','2015-12-22','2015-12-26',47),"
                            + "(6,21,6,'Operation 43','2015-12-23','2015-12-25',18),"
                            + "(21,19,6,'Operation 44','2016-01-07','2016-01-12',50),"
                            + "(9,23,7,'Operation 45','2016-01-12','2016-01-14',27),"
                            + "(9,28,1,'Operation 46','2016-01-20','2016-01-21',21),"
                            + "(32,22,4,'Operation 47','2016-01-25','2016-01-29',44),"
                            + "(30,27,4,'Operation 48','2016-02-29','2016-03-04',46),"
                            + "(11,19,1,'Operation 49','2016-03-07','2016-03-09',18),"
                            + "(28,23,1,'Operation 50','2016-03-07','2016-03-10',33),"
                            + "(14,26,3,'Operation 51','2016-03-22','2016-03-24',21),"
                            + "(6,25,3,'Operation 52','2016-03-30','2016-04-02',28),"
                            + "(6,25,7,'Operation 53','2016-04-01','2016-04-05',35),"
                            + "(32,23,2,'Operation 54','2016-04-02','2016-04-04',26),"
                            + "(5,18,6,'Operation 55','2016-04-02','2016-04-05',38),"
                            + "(20,18,7,'Operation 56','2016-04-04','2016-04-05',13),"
                            + "(26,26,7,'Operation 57','2016-04-08','2016-04-11',29),"
                            + "(30,24,6,'Operation 58','2016-04-16','2016-04-21',46),"
                            + "(2,21,1,'Operation 59','2016-04-16','2016-04-18',31),"
                            + "(20,21,4,'Operation 60','2016-04-17','2016-04-20',34),"
                            + "(3,24,2,'Operation 61','2016-04-18','2016-04-21',37),"
                            + "(11,21,5,'Operation 62','2016-04-28','2016-04-29',15),"
                            + "(21,25,6,'Operation 63','2016-05-14','2016-05-17',28),"
                            + "(6,28,3,'Operation 64','2016-05-19','2016-05-20',14),"
                            + "(10,21,6,'Operation 65','2016-05-23','2016-05-26',35),"
                            + "(20,28,1,'Operation 66','2016-05-30','2016-06-04',53),"
                            + "(27,29,2,'Operation 67','2016-06-12','2016-06-13',20),"
                            + "(33,29,7,'Operation 68','2016-06-27','2016-07-02',55),"
                            + "(15,28,4,'Operation 69','2016-07-01','2016-07-04',40),"
                            + "(22,22,7,'Operation 70','2016-07-06','2016-07-11',47),"
                            + "(19,27,1,'Operation 71','2016-07-13','2016-07-16',30),"
                            + "(17,24,6,'Operation 72','2016-08-28','2016-08-30',23),"
                            + "(26,28,2,'Operation 73','2016-08-30','2016-08-31',24),"
                            + "(26,23,1,'Operation 74','2016-09-11','2016-09-16',48),"
                            + "(1,23,3,'Operation 75','2016-09-26','2016-09-26',2),"
                            + "(29,21,6,'Operation 76','2016-10-13','2016-10-18',47),"
                            + "(31,29,1,'Operation 77','2016-11-11','2016-11-16',47),"
                            + "(30,27,4,'Operation 78','2016-11-24','2016-11-26',26),"
                            + "(12,26,5,'Operation 79','2016-11-30','2016-11-30',13),"
                            + "(18,23,7,'Operation 80','2016-12-04','2016-12-04',8),"
                            + "(25,19,5,'Operation 81','2016-12-15','2016-12-19',36),"
                            + "(2,26,5,'Operation 82','2016-12-16','2016-12-17',16),"
                            + "(14,28,6,'Operation 83','2016-12-18','2016-12-21',33),"
                            + "(29,24,6,'Operation 84','2017-01-03','2017-01-05',24),"
                            + "(3,28,4,'Operation 85','2017-01-11','2017-01-14',29),"
                            + "(18,28,4,'Operation 86','2017-01-17','2017-01-20',33),"
                            + "(26,28,4,'Operation 87','2017-01-19','2017-01-23',41),"
                            + "(10,18,5,'Operation 88','2017-02-03','2017-02-04',24),"
                            + "(27,27,5,'Operation 89','2017-02-16','2017-02-17',16),"
                            + "(25,19,1,'Operation 90','2017-02-23','2017-02-27',46),"
                            + "(14,21,5,'Operation 91','2017-02-27','2017-02-28',20),"
                            + "(34,28,6,'Operation 92','2017-03-13','2017-03-13',8),"
                            + "(21,23,3,'Operation 93','2017-03-13','2017-03-16',30),"
                            + "(21,20,4,'Operation 94','2017-03-17','2017-03-22',51),"
                            + "(11,19,1,'Operation 95','2017-03-19','2017-03-24',54),"
                            + "(34,20,4,'Operation 96','2017-03-26','2017-03-31',44),"
                            + "(29,23,5,'Operation 97','2017-04-10','2017-04-14',42),"
                            + "(3,19,3,'Operation 98','2017-04-20','2017-04-21',18),"
                            + "(8,23,2,'Operation 99','2017-04-23','2017-04-24',14),"
                            + "(25,19,3,'Operation 100','2017-05-05','2017-05-10',50),"
                            + "(30,21,2,'Operation 101','2017-05-07','2017-05-07',5),"
                            + "(4,25,6,'Operation 102','2017-05-13','2017-05-16',38),"
                            + "(12,29,2,'Operation 103','2017-05-22','2017-05-25',33),"
                            + "(22,23,4,'Operation 104','2017-05-28','2017-05-28',10),"
                            + "(4,25,7,'Operation 105','2017-06-02','2017-06-07',53),"
                            + "(21,18,2,'Operation 106','2017-06-04','2017-06-08',43),"
                            + "(14,21,6,'Operation 107','2017-06-09','2017-06-12',35),"
                            + "(28,25,7,'Operation 108','2017-06-21','2017-06-21',10),"
                            + "(11,19,4,'Operation 109','2017-07-08','2017-07-10',30),"
                            + "(7,19,1,'Operation 110','2017-07-10','2017-07-14',43),"
                            + "(19,22,6,'Operation 111','2017-07-11','2017-07-15',42),"
                            + "(12,20,5,'Operation 112','2017-07-21','2017-07-26',53),"
                            + "(25,19,6,'Operation 113','2017-07-24','2017-07-26',29),"
                            + "(9,26,5,'Operation 114','2017-08-02','2017-08-03',19),"
                            + "(22,29,2,'Operation 115','2017-08-06','2017-08-06',7),"
                            + "(7,29,6,'Operation 116','2017-08-10','2017-08-13',37),"
                            + "(12,25,6,'Operation 117','2017-09-04','2017-09-08',46),"
                            + "(1,26,7,'Operation 118','2017-09-20','2017-09-25',52),"
                            + "(30,29,6,'Operation 119','2017-09-28','2017-10-02',48),"
                            + "(26,24,5,'Operation 120','2017-09-29','2017-10-04',56),"
                            + "(29,25,5,'Operation 121','2017-10-08','2017-10-12',34),"
                            + "(17,29,7,'Operation 122','2017-10-15','2017-10-20',46),"
                            + "(4,23,2,'Operation 123','2017-10-19','2017-10-22',39),"
                            + "(32,28,7,'Operation 124','2017-10-24','2017-10-24',10),"
                            + "(33,27,4,'Operation 125','2017-10-28','2017-11-01',35),"
                            + "(28,21,7,'Operation 126','2017-11-20','2017-11-20',14),"
                            + "(18,25,1,'Operation 127','2017-11-23','2017-11-27',36),"
                            + "(19,26,3,'Operation 128','2017-12-03','2017-12-07',40),"
                            + "(17,25,2,'Operation 129','2017-12-08','2017-12-10',19),"
                            + "(13,25,2,'Operation 130','2017-12-24','2017-12-25',17),"
                            + "(15,26,4,'Operation 131','2018-01-06','2018-01-06',7),"
                            + "(28,23,1,'Operation 132','2018-01-15','2018-01-20',44),"
                            + "(29,22,3,'Operation 133','2018-01-19','2018-01-23',37),"
                            + "(18,26,7,'Operation 134','2018-01-23','2018-01-24',10),"
                            + "(13,19,1,'Operation 135','2018-01-25','2018-01-29',47),"
                            + "(19,22,7,'Operation 136','2018-02-11','2018-02-15',39),"
                            + "(28,19,1,'Operation 137','2018-02-15','2018-02-17',20),"
                            + "(24,27,6,'Operation 138','2018-02-15','2018-02-20',46),"
                            + "(24,20,4,'Operation 139','2018-02-18','2018-02-18',12),"
                            + "(14,21,7,'Operation 140','2018-03-03','2018-03-06',36),"
                            + "(16,20,1,'Operation 141','2018-03-03','2018-03-06',38),"
                            + "(10,20,7,'Operation 142','2018-03-06','2018-03-10',34),"
                            + "(4,25,4,'Operation 143','2018-03-07','2018-03-09',27),"
                            + "(18,18,1,'Operation 144','2018-03-21','2018-03-23',21),"
                            + "(1,29,4,'Operation 145','2018-03-26','2018-03-26',9),"
                            + "(14,29,5,'Operation 146','2018-03-27','2018-03-29',31),"
                            + "(14,18,1,'Operation 147','2018-04-07','2018-04-08',15),"
                            + "(6,23,1,'Operation 148','2018-04-08','2018-04-11',29),"
                            + "(15,21,6,'Operation 149','2018-04-13','2018-04-16',35),"
                            + "(6,21,1,'Operation 150','2018-04-16','2018-04-17',14),"
                            + "(30,25,3,'Operation 151','2018-04-20','2018-04-20',2),"
                            + "(23,27,6,'Operation 152','2018-05-05','2018-05-10',47),"
                            + "(8,25,4,'Operation 153','2018-05-18','2018-05-21',31),"
                            + "(4,21,3,'Operation 154','2018-05-21','2018-05-24',33),"
                            + "(8,29,7,'Operation 155','2018-05-25','2018-05-30',45),"
                            + "(5,24,7,'Operation 156','2018-05-30','2018-06-03',37),"
                            + "(26,20,1,'Operation 157','2018-05-31','2018-06-01',24),"
                            + "(17,29,5,'Operation 158','2018-06-01','2018-06-02',19),"
                            + "(32,27,6,'Operation 159','2018-06-02','2018-06-05',34),"
                            + "(28,25,4,'Operation 160','2018-06-03','2018-06-06',35),"
                            + "(23,19,3,'Operation 161','2018-06-06','2018-06-10',39),"
                            + "(16,29,4,'Operation 162','2018-06-13','2018-06-18',55),"
                            + "(24,27,6,'Operation 163','2018-06-24','2018-06-29',49),"
                            + "(21,22,3,'Operation 164','2018-07-03','2018-07-06',31),"
                            + "(12,29,4,'Operation 165','2018-07-12','2018-07-16',34),"
                            + "(19,21,6,'Operation 166','2018-07-15','2018-07-19',37),"
                            + "(10,22,4,'Operation 167','2018-07-15','2018-07-17',22),"
                            + "(16,29,1,'Operation 168','2018-07-27','2018-07-28',16),"
                            + "(6,21,3,'Operation 169','2018-08-06','2018-08-08',24),"
                            + "(6,27,1,'Operation 170','2018-08-08','2018-08-11',37),"
                            + "(11,26,6,'Operation 171','2018-08-18','2018-08-18',10),"
                            + "(31,28,4,'Operation 172','2018-08-31','2018-09-03',27),"
                            + "(25,26,5,'Operation 173','2018-09-02','2018-09-07',54),"
                            + "(32,20,4,'Operation 174','2018-09-05','2018-09-08',26),"
                            + "(6,21,1,'Operation 175','2018-09-19','2018-09-21',30)");
                    System.out.println("OPERATIONS inserted");
                } catch (SQLException e) {
                    JOptionPane.showMessageDialog(null, "CreateOperationsTable Database Error: " + e,
                            "Error", JOptionPane.ERROR_MESSAGE);
                }

            } catch (SQLException e) {
                JOptionPane.showMessageDialog(null, "CreateOperationsTable Database Error: " + e,
                        "Error", JOptionPane.ERROR_MESSAGE);
            }
        }

    }

}
